(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{129:function(n,e,a){"use strict";a.d(e,"b",function(){return r}),a.d(e,"a",function(){return s});var t=a(92),i=a(90);function r(){var n=Object.assign({},i.c,{g_tk:5381,uin:0,platform:"h5",needNewCode:1,_:(new Date).getTime()});return Object(t.a)(i.d.rankingList,n,i.b)}function s(n){var e=Object.assign({},i.c,{g_tk:5381,uin:0,platform:"h5",needNewCode:1,tpl:3,page:"detail",type:"top",topid:n,_:(new Date).getTime()});return Object(t.a)(i.d.rankingInfo,e,i.b)}},130:function(n,e,a){"use strict";a.d(e,"b",function(){return s}),a.d(e,"a",function(){return o});var t=a(3),i=a(29),r=function n(e,a,i,r){Object(t.a)(this,n),this.id=e,this.title=a,this.img=i,this.songs=r};function s(n){var e=[];return n.songList.forEach(function(n){e.push(new i.a(0,"",n.songname,"",0,"",n.singername))}),new r(n.id,n.topTitle,n.picUrl,e)}function o(n){return new r(n.topID,n.ListName,n.pic_v12,[])}},216:function(n,e,a){n.exports={"ranking-img":"rankinginfo_ranking-img__3Ic_n",rankingImg:"rankinginfo_ranking-img__3Ic_n",fixed:"rankinginfo_fixed__sv27K","play-wrapper":"rankinginfo_play-wrapper__1RnwA",playWrapper:"rankinginfo_play-wrapper__1RnwA","play-button":"rankinginfo_play-button__1Z79g",playButton:"rankinginfo_play-button__1Z79g",filter:"rankinginfo_filter__5r__h","ranking-container":"rankinginfo_ranking-container__bZnyF",rankingContainer:"rankinginfo_ranking-container__bZnyF","ranking-scroll":"rankinginfo_ranking-scroll__3u_R9",rankingScroll:"rankinginfo_ranking-scroll__3u_R9","ranking-wrapper":"rankinginfo_ranking-wrapper__LFZxZ",rankingWrapper:"rankinginfo_ranking-wrapper__LFZxZ","ranking-count":"rankinginfo_ranking-count__1rIPQ",rankingCount:"rankinginfo_ranking-count__1rIPQ","song-list":"rankinginfo_song-list__2UjRN",songList:"rankinginfo_song-list__2UjRN",song:"rankinginfo_song__3xR7v","song-index":"rankinginfo_song-index__tar2_",songIndex:"rankinginfo_song-index__tar2_",info:"rankinginfo_info__hHxcA","ranking-title":"rankinginfo_ranking-title__30krS",rankingTitle:"rankinginfo_ranking-title__30krS","ranking-desc":"rankinginfo_ranking-desc__MCczQ",rankingDesc:"rankinginfo_ranking-desc__MCczQ"}},228:function(n,e,a){"use strict";a.r(e);var t=a(15),i=a(16),r=a(3),s=a(5),o=a(7),c=a(6),l=a(8),g=a(0),f=a.n(g),k=a(14),u=a(140),p=a(28),_=a(93),m=a(118),d=a(129),h=a(117),v=a(90),y=a(130),b=a(29),E=a(216),R=a.n(E),w=function(n){function e(n){var a;return Object(r.a)(this,e),(a=Object(o.a)(this,Object(c.a)(e).call(this,n))).playAll=function(){a.state.songs.length>0&&(a.props.setSongs(a.state.songs),a.props.changeCurrentSong(a.state.songs[0]),a.props.showMusicPlayer(!0))},a.scroll=function(n){var e=n.y,t=a.rankingBgRef.current,i=a.rankingFixedBgRef.current,r=a.playButtonWrapperRef.current;if(e<0)Math.abs(e)+55>t.offsetHeight?i.style.display="block":i.style.display="none";else{var s="scale(".concat(1+.004*e,", ").concat(1+.004*e,")");t.style.webkitTransform=s,t.style.transform=s,r.style.marginTop="".concat(e,"px")}},a.rankingBgRef=f.a.createRef(),a.rankingContainerRef=f.a.createRef(),a.rankingFixedBgRef=f.a.createRef(),a.playButtonWrapperRef=f.a.createRef(),a.musicalNoteRef=f.a.createRef(),a.state={show:!1,loading:!0,ranking:{},songs:[]},a}return Object(l.a)(e,n),Object(s.a)(e,[{key:"componentDidMount",value:function(){this.setState({show:!0}),this.rankingContainerRef.current.style.top=this.rankingBgRef.current.offsetHeight+"px"}},{key:"getRankingInfo",value:function(){var n=this;Object(d.a)(this.props.match.params.id).then(function(e){if(e&&e.code===v.a){var a=y.a(e.topinfo);a.info=e.topinfo.info;var t=[];e.songlist.forEach(function(e){if(1!==e.data.pay.payplay){var a=b.b(e.data);n.getSongUrl(a,e.data.songmid),t.push(a)}}),n.setState({loading:!1,ranking:a,songs:t})}})}},{key:"getSongUrl",value:function(n,e){Object(h.a)(e).then(function(e){if(e&&e.code===v.a&&e.data.items){var a=e.data.items[0];n.url="http://dl.stream.qqmusic.qq.com/".concat(a.filename,"?vkey=").concat(a.vkey,"&guid=3655047200&fromtag=66")}})}},{key:"selectSong",value:function(n){var e=this;return function(a){e.props.setSongs([n]),e.props.changeCurrentSong(n),e.musicalNoteRef.current.startAnimation({x:a.nativeEvent.clientX,y:a.nativeEvent.clientY})}}},{key:"render",value:function(){var n=this,e=this.state.ranking,a={};e.img&&(a.backgroundImage="url(".concat(e.img,")"));var t=this.state.songs.map(function(e,a){return f.a.createElement("div",{className:R.a.song,key:e.id,onClick:n.selectSong(e)},f.a.createElement("div",{className:R.a.songIndex},a+1),f.a.createElement("div",{className:"song-name"},e.name),f.a.createElement("div",{className:"song-singer"},e.singer))});return f.a.createElement(k.CSSTransition,{in:this.state.show,timeout:300,classNames:"translate",onEntered:function(){n.getRankingInfo()}},f.a.createElement("div",{className:"ranking-info"},f.a.createElement(u.a,{title:e.title}),f.a.createElement("div",{style:{position:"relative"}},f.a.createElement("div",{ref:this.rankingBgRef,className:R.a.rankingImg,style:a},f.a.createElement("div",{className:R.a.filter})),f.a.createElement("div",{ref:this.rankingFixedBgRef,className:R.a.rankingImg+" "+R.a.fixed,style:a},f.a.createElement("div",{className:R.a.filter})),f.a.createElement("div",{className:R.a.playWrapper,ref:this.playButtonWrapperRef},f.a.createElement("div",{className:R.a.playButton,onClick:this.playAll},f.a.createElement("i",{className:"icon-play"}),f.a.createElement("span",null,"\u64ad\u653e\u5168\u90e8")))),f.a.createElement("div",{ref:this.rankingContainerRef,className:R.a.rankingContainer},f.a.createElement("div",{className:R.a.rankingScroll,style:!0===this.state.loading?{display:"none"}:{}},f.a.createElement(p.a,{onScroll:this.scroll},f.a.createElement("div",{className:"".concat(R.a.rankingWrapper," skin-detail-wrapper")},f.a.createElement("div",{className:R.a.rankingCount},"\u6392\u884c\u699c \u5171",t.length,"\u9996"),f.a.createElement("div",{className:R.a.songList},t),f.a.createElement("div",{className:R.a.info,style:e.info?{}:{display:"none"}},f.a.createElement("h1",{className:R.a.rankingTitle},"\u7b80\u4ecb"),f.a.createElement("div",{className:R.a.rankingDesc,dangerouslySetInnerHTML:{__html:e.info}}))))),f.a.createElement(_.a,{title:"\u6b63\u5728\u52a0\u8f7d...",show:this.state.loading})),f.a.createElement(m.a,{ref:this.musicalNoteRef})))}}]),e}(f.a.Component);e.default=Object(t.b)(null,function(n){return{showMusicPlayer:function(e){n(Object(i.e)(e))},changeCurrentSong:function(e){n(Object(i.a)(e))},setSongs:function(e){n(Object(i.d)(e))}}})(w)}}]);